{% extends "base.html" %}
{% block title %}Ch·ªânh s·ª≠a s·ª± ki·ªán{% endblock %}

{% block extra_css %}
<style>
{{ block.super }}

/* ===== CARD CHUNG ===== */
.card {
  background: #fff9e6;
  border-radius: 16px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.05);
  padding: 30px 40px;
  margin: 40px auto;
  max-width: 700px;
  animation: fadeIn 0.5s ease-in-out;
  font-family: 'Be Vietnam Pro', sans-serif;
}

/* ===== TI√äU ƒê·ªÄ ===== */
.card h3 {
  font-size: 22px;
  font-weight: 700;
  color: #003459;
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 18px;
}

/* ===== FORM ===== */
.synced-form {
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.synced-form label {
  font-weight: 600;
  color: #003459;
  margin-bottom: 5px;
  font-size: 15px;
}

.synced-form input[type="text"],
.synced-form input[type="datetime-local"],
.synced-form input[type="file"],
.synced-form textarea,
.synced-form input[type="number"],
.synced-form select {
  width: 100%;
  border: 1.5px solid #ccc;
  border-radius: 10px;
  background: #fff;
  padding: 10px 12px;
  font-size: 15px;
  transition: 0.2s ease-in-out;
  box-sizing: border-box;
  font-family: 'Be Vietnam Pro', sans-serif;
}

.synced-form textarea {
  min-height: 130px;
  line-height: 1.5;
}

.synced-form input:focus,
.synced-form textarea:focus,
.synced-form select:focus {
  outline: none;
  border-color: #003459;
  box-shadow: 0 0 4px rgba(0, 52, 89, 0.3);
}

/* ===== BUTTONS ===== */
.form-buttons {
  display: flex;
  gap: 12px;
  margin-top: 20px;
}

.btn-primary {
  background: #003459;
  color: #fff;
  border: none;
  border-radius: 10px;
  padding: 10px 22px;
  font-weight: 600;
  cursor: pointer;
  font-size: 15px;
  transition: 0.2s;
}
.btn-primary:hover {
  background: #005b8f;
  transform: translateY(-2px);
}

.btn-secondary {
  background: #f1f1f1;
  color: #003459;
  border: 1.5px solid #ccc;
  border-radius: 10px;
  padding: 10px 22px;
  font-weight: 600;
  text-decoration: none;
  font-size: 15px;
  transition: 0.2s;
}
.btn-secondary:hover {
  background: #e5e5e5;
}

/* ===== ·∫¢NH XEM TR∆Ø·ªöC ===== */
.preview {
  margin-top: 10px;
  text-align: center;
}
.preview img {
  max-width: 100%;
  max-height: 250px;
  border-radius: 10px;
  margin-top: 10px;
  border: 1px solid #ddd;
}

/* Hi·ªáu ·ª©ng */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(15px); }
  to { opacity: 1; transform: translateY(0); }
}
</style>
{% endblock %}

{% block content %}
<div class="card">
  <h3>‚úèÔ∏è Ch·ªânh s·ª≠a s·ª± ki·ªán</h3>

  <form method="post" enctype="multipart/form-data" class="synced-form">
    {% csrf_token %}

    <label for="{{ form.title.id_for_label }}">üéØ Ti√™u ƒë·ªÅ:</label>
    {{ form.title }}

    <label for="{{ form.description.id_for_label }}">üìù M√¥ t·∫£:</label>
    {{ form.description }}

    <label for="{{ form.date.id_for_label }}">üóì Th·ªùi gian b·∫Øt ƒë·∫ßu:</label>
    {{ form.date }}

    <label for="{{ form.end_date.id_for_label }}">‚åõ Th·ªùi gian k·∫øt th√∫c:</label>
    {{ form.end_date }}

    <label for="{{ form.location.id_for_label }}">üìç ƒê·ªãa ƒëi·ªÉm:</label>
    {{ form.location }}

    <label for="id_capacity">üë• S·ªë l∆∞·ª£ng ng∆∞·ªùi tham gia t·ªëi ƒëa:</label>
    {{ form.capacity }}

    <label for="{{ form.image.id_for_label }}">üñº ·∫¢nh b√¨a:</label>
    {{ form.image }}
    <div class="preview" id="imagePreview">
      {% if event.image %}
        <img src="{{ event.image.url }}" alt="·∫¢nh hi·ªán t·∫°i">
      {% else %}
        <p><em>·∫¢nh s·∫Ω hi·ªÉn th·ªã t·∫°i ƒë√¢y sau khi ch·ªçn</em></p>
      {% endif %}
    </div>

    <div class="form-buttons">
      <button type="submit" class="btn-primary">üíæ L∆∞u thay ƒë·ªïi</button>
      <a href="{% url 'danh_sach_su_kien' %}" class="btn-secondary">‚Ü© Quay l·∫°i</a>
    </div>
  </form>
</div>

<script>
const imageInput = document.getElementById('id_image');
const preview = document.getElementById('imagePreview');

if (imageInput) {
  imageInput.addEventListener('change', function() {
    const file = this.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function(e) {
        preview.innerHTML = `<img src="${e.target.result}" alt="Xem tr∆∞·ªõc ·∫£nh">`;
      }
      reader.readAsDataURL(file);
    } else {
      preview.innerHTML = '<p><em>·∫¢nh s·∫Ω hi·ªÉn th·ªã t·∫°i ƒë√¢y sau khi ch·ªçn</em></p>';
    }
  });
}
</script>
{% endblock %}
