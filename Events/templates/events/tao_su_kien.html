{% extends "base.html" %}
{% load static %}
{% block title %}T·∫°o s·ª± ki·ªán m·ªõi ‚Ä¢ PetTalk{% endblock %}

{% block content %}
<style>
.form-wrapper {
    background: #fff9e6;
    padding: 30px 40px;
    border-radius: 20px;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
    max-width: 700px;
    margin: 40px auto;
    font-family: "Be Vietnam Pro", sans-serif;
    color: #222;
}

.form-wrapper h2 {
    display: flex;
    align-items: center;
    font-weight: 700;
    color: #003459;
    font-size: 24px;
    margin-bottom: 10px;
}

.form-wrapper h2::before {
    content: "üìÖ";
    margin-right: 10px;
    font-size: 26px;
}

.form-wrapper p.note {
    color: #333;
    font-size: 15px;
    margin-bottom: 25px;
}

.form-wrapper form {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.form-wrapper label {
    font-weight: 600;
    color: #003459;
}

.form-wrapper input,
.form-wrapper textarea {
    width: 100%;
    border: 1.5px solid #ccc;
    border-radius: 10px;
    padding: 10px 12px;
    font-size: 15px;
    transition: all 0.2s ease-in-out;
    background: white;
}

.form-wrapper input:focus,
.form-wrapper textarea:focus {
    outline: none;
    border-color: #003459;
    box-shadow: 0 0 4px rgba(0, 52, 89, 0.3);
}

.form-wrapper button {
    align-self: flex-start;
    background: #003459;
    color: white;
    font-weight: 600;
    border: none;
    border-radius: 8px;
    padding: 10px 22px;
    font-size: 15px;
    transition: 0.2s;
}

.form-wrapper button:hover {
    background: #005b8f;
    transform: translateY(-1px);
}

.preview {
    margin-top: 15px;
    text-align: center;
}

.preview img {
    max-width: 100%;
    max-height: 250px;
    border-radius: 10px;
    margin-top: 10px;
    border: 1px solid #ddd;
}

/* ‚ö†Ô∏è Th√¥ng b√°o l·ªói */
.error-text {
    color: #d32f2f;
    font-size: 14px;
    margin-top: 3px;
    margin-left: 3px;
}

/* L·ªói chung to√†n form */
.errorlist.nonfield {
    background: #ffeaea;
    color: #b71c1c;
    border-radius: 8px;
    padding: 10px 14px;
    margin-bottom: 10px;
    font-weight: 500;
    list-style: none;
}
</style>

<div class="form-wrapper">
  <h2>T·∫°o s·ª± ki·ªán m·ªõi</h2>
  <p class="note">
    Vui l√≤ng nh·∫≠p th√¥ng tin ƒë·ªÉ ƒëƒÉng s·ª± ki·ªán. Sau khi g·ª≠i, s·ª± ki·ªán s·∫Ω ƒë∆∞·ª£c chuy·ªÉn sang tr·∫°ng th√°i
    <strong>ch·ªù ph√™ duy·ªát</strong>.
  </p>

  <form method="POST" enctype="multipart/form-data">
    {% csrf_token %}

    {# ‚ö†Ô∏è L·ªói chung (nh∆∞ ng√†y k·∫øt th√∫c < ng√†y b·∫Øt ƒë·∫ßu) #}
    {% if form.non_field_errors %}
      <ul class="errorlist nonfield">
        {% for error in form.non_field_errors %}
          <li>{{ error }}</li>
        {% endfor %}
      </ul>
    {% endif %}

    <label for="id_title">Ti√™u ƒë·ªÅ:</label>
    {{ form.title }}
    {% if form.title.errors %}
      <div class="error-text">{{ form.title.errors.0 }}</div>
    {% endif %}

    <label for="id_description">M√¥ t·∫£:</label>
    {{ form.description }}
    {% if form.description.errors %}
      <div class="error-text">{{ form.description.errors.0 }}</div>
    {% endif %}

    <label for="id_date">Th·ªùi gian b·∫Øt ƒë·∫ßu:</label>
    {{ form.date }}
    {% if form.date.errors %}
      <div class="error-text">{{ form.date.errors.0 }}</div>
    {% endif %}

    <label for="id_end_date">Th·ªùi gian k·∫øt th√∫c:</label>
    {{ form.end_date }}
    {% if form.end_date.errors %}
      <div class="error-text">{{ form.end_date.errors.0 }}</div>
    {% endif %}

    <label for="id_location">ƒê·ªãa ƒëi·ªÉm:</label>
    {{ form.location }}
    {% if form.location.errors %}
      <div class="error-text">{{ form.location.errors.0 }}</div>
    {% endif %}

    <label for="id_capacity">S·ªë l∆∞·ª£ng ng∆∞·ªùi tham gia t·ªëi ƒëa:</label>
    {{ form.capacity }}


    <label for="id_image">·∫¢nh b√¨a:</label>
    {{ form.image }}
    {% if form.image.errors %}
      <div class="error-text">{{ form.image.errors.0 }}</div>
    {% endif %}

    <div class="preview" id="imagePreview">
      <p><em>·∫¢nh s·∫Ω hi·ªÉn th·ªã t·∫°i ƒë√¢y sau khi ch·ªçn</em></p>
    </div>

    <button type="submit">G·ª≠i ph√™ duy·ªát</button>
  </form>
</div>

<script>
const imageInput = document.getElementById('id_image');
const preview = document.getElementById('imagePreview');

imageInput.addEventListener('change', function(){
  const file = this.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload = function(e){
      preview.innerHTML = `<img src="${e.target.result}" alt="Xem tr∆∞·ªõc ·∫£nh">`;
    }
    reader.readAsDataURL(file);
  } else {
    preview.innerHTML = '<p><em>·∫¢nh s·∫Ω hi·ªÉn th·ªã t·∫°i ƒë√¢y sau khi ch·ªçn</em></p>';
  }
});
</script>
{% endblock %}
