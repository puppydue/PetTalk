{% extends "base.html" %}
{% load static %}

{% block title %}Äiá»ƒm thÆ°á»Ÿng & Danh hiá»‡u{% endblock %}

{% block extra_css %}
<style>
    body {
        background: #fff8ed; /* Ná»€N VÃ€NG GIá»NG PROFILE */
    }

    /* ... (CSS cÅ© cho :root, card, title, muted, btn, toolbar, brow, etc. giá»¯ nguyÃªn) ... */
    :root{
      /* ... (biáº¿n mÃ u) ... */
      --primary: #003459;
      --secondary: #F7DBA7;
      --bg: #f8fafc;
      --card: #ffffff;
      --line: #e2e8f0;
      --text: #0f172a;
      --muted: #475569;
      --radius: 14px;
      --success:#16a34a;
      --warn:#f59e0b;
      --danger:#ef4444;
      --shadow:0 14px 34px rgba(16,24,40,.10);
    }
    *{box-sizing:border-box}
    a{color:inherit;text-decoration:none}

    .card {
        background: var(--card);
        border: 1px solid var(--line);
        border-radius: var(--radius);
        padding: 20px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        margin-bottom: 24px;
    }
     .header-card {
       padding: 20px;
       border-radius: var(--radius);
       background: var(--card);
       border: 1px solid var(--line);
       margin-bottom: 16px;
       box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }
    .title{font-weight:900;font-size:18px;margin:0 0 12px}
    .muted{color:var(--muted);font-size:13px}
    .btn{
        padding:10px 14px;
        border:1px solid var(--line);
        background:#fff;
        border-radius:12px;
        cursor:pointer;
        box-shadow:var(--shadow);
        font-family: inherit;
        font-weight: 500;
    }
    .btn.primary{
        background: var(--primary);
        color:#fff;
        border-color:transparent
    }
    .toolbar{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .toolbar .btn{padding:8px 12px}
    .brow{display:grid;grid-template-columns:56px 1fr 120px;gap:14px;align-items:center;padding:12px;border:1px solid var(--line);border-radius:14px;background:linear-gradient(180deg,#ffffff,#fafcff);box-shadow:var(--shadow);margin:10px 0}
    .bicon{width:56px;height:56px;border-radius:14px;display:grid;place-items:center;font-size:26px;background:conic-gradient(from 180deg, #e6f0ff, #f8fbff);border:1px solid #e3e8ff}
    .bname{font-weight:900}
    .bmeta{color:#475569;font-size:13px;margin-top:2px}
    .bar{height:12px;background:#eef2ff;border:1px solid #dbe3ff;border-radius:999px;overflow:hidden;margin-top:8px;position:relative}
    .bar>div{height:100%;background:linear-gradient(90deg,#93c5fd,#2563eb);position:relative}
    .bar>div:after{content:"";position:absolute;right:0;top:0;height:100%;width:10px;background:radial-gradient(circle at 70% 50%, rgba(255,255,255,.9), rgba(255,255,255,0));mix-blend-mode:overlay}
    .bstat{display:flex;justify-content:space-between;align-items:center;font-size:12px;color:#334155;margin-top:8px}
    .tag{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;background:#f0f9ff;border:1px solid #bae6fd;font-size:12px}
    .ok-chip{display:inline-flex;align-items:center;gap:6px;background:#ecfdf5;border:1px solid #86efac;color:#166534;border-radius:999px;padding:4px 10px;font-weight:800}
    .chip-warn{background:#fff7ed;border:1px solid #fed7aa;color:#b45309;border-radius:999px;padding:4px 10px;font-size:12px}

    /* CSS CHO PANEL BÃŠN PHáº¢I */
    .display-badge-option {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 12px;
        cursor: pointer;
        padding: 8px;
        border-radius: 8px;
        transition: background-color 0.2s ease;
    }
    .display-badge-option:hover {
        background-color: #f1f5f9;
    }
    .display-badge-option input[type="radio"] {
        appearance: none;
        -webkit-appearance: none;
        margin: 0;
        width: 20px;
        height: 20px;
        border: 2px solid var(--line);
        border-radius: 50%;
        cursor: pointer;
        position: relative;
        transition: border-color 0.2s ease, background-color 0.2s ease;
    }
    .display-badge-option input[type="radio"]:checked {
        border-color: var(--primary);
        background-color: var(--primary);
    }
    .display-badge-option input[type="radio"]:checked::after {
        content: '';
        display: block;
        width: 5px;
        height: 10px;
        border: solid white;
        border-width: 0 3px 3px 0;
        transform: rotate(45deg);
        position: absolute;
        left: 6px;
        top: 2px;
    }
    .display-badge-option label {
        font-weight: 500;
        cursor: pointer;
        flex-grow: 1;
    }
    .selected-badge-info {
        font-size: 13px;
        color: var(--muted);
        margin-top: 10px;
        border-top: 1px solid var(--line);
        padding-top: 10px;
    }

</style>
{% endblock %}


{% block content %}
<main id="center">
    <div class="header-card">
        <h2 class="title">Danh hiá»‡u há»‡ thá»‘ng</h2>
        <p class="muted">Chu ká»³: <span id="periodStartLbl">1/1/2025</span> â†’ <span id="periodEndLbl">1/1/2026</span>. Khi háº¿t háº¡n, tiáº¿n trÃ¬nh <b>tá»± Ä‘á»™ng vá» 0</b>.</p>
        <div class="toolbar">
            <span class="tag">ğŸ¯ Má»¥c tiÃªu nÄƒm nay</span>
            <span class="chip-warn" id="daysLeftLbl">â³ CÃ²n 71 ngÃ y trong ká»³</span>
        </div>
    </div>

    <section id="tab-badges">
        <div id="badgesList">
            <div class="brow" style="border-left:6px solid #f59e0b20"> <div class="bicon" style="background:conic-gradient(from 180deg, #f59e0b22, #fff); border-color:#f59e0b33">ğŸ…</div>
                <div>
                  <div class="bname">Vua sáº» chia</div>
                  <div class="bmeta">ÄÄƒng â‰¥ 50 bÃ i Â· <b>312</b> ngÆ°á»i Ä‘Ã£ Ä‘áº¡t</div>
                  <div class="bar"><div style="width:100%; background:linear-gradient(90deg, #f59e0b, #fbbf24)"></div></div>
                  <div class="bstat">
                    <span>Tiáº¿n trÃ¬nh cá»§a báº¡n: <b>60/50</b> bÃ i viáº¿t</span>
                    <span><span class="ok-chip">ÄÃƒ HOÃ€N THÃ€NH</span></span>
                  </div>
                </div>
                <div style="display:grid;gap:8px;justify-items:end">
                  <span class="tag">Má»¥c tiÃªu: 50 bÃ i viáº¿t</span>
                  <button class="btn" onclick="alert('Máº¹o Ä‘áº¡t '+ 'Vua sáº» chia')">ğŸ’¡ Máº¹o</button>
                </div>
            </div>
            <div class="brow" style="border-left:6px solid #0891b220"> <div class="bicon" style="background:conic-gradient(from 180deg, #0891b222, #fff); border-color:#0891b233">ğŸ’¬</div>
                <div>
                  <div class="bname">BÃ¬nh luáº­n há»¯u Ã­ch</div>
                  <div class="bmeta">100 like cho bÃ¬nh luáº­n Â· <b>198</b> ngÆ°á»i Ä‘Ã£ Ä‘áº¡t</div>
                  <div class="bar"><div style="width:76%; background:linear-gradient(90deg, #0891b2, #60a5fa)"></div></div>
                  <div class="bstat">
                    <span>Tiáº¿n trÃ¬nh cá»§a báº¡n: <b>76/100</b> like</span>
                    <span>CÃ²n 24 Ä‘á»ƒ Ä‘áº¡t</span>
                  </div>
                </div>
                <div style="display:grid;gap:8px;justify-items:end">
                  <span class="tag">Má»¥c tiÃªu: 100 like</span>
                  <button class="btn" onclick="alert('Máº¹o Ä‘áº¡t '+ 'BÃ¬nh luáº­n há»¯u Ã­ch')">ğŸ’¡ Máº¹o</button>
                </div>
            </div>
            <div class="brow" style="border-left:6px solid #16a34a20"> <div class="bicon" style="background:conic-gradient(from 180deg, #16a34a22, #fff); border-color:#16a34a33">ğŸ§­</div>
                <div>
                  <div class="bname">NgÆ°á»i dáº«n Ä‘Æ°á»ng</div>
                  <div class="bmeta">GhÃ©p cáº·p tÃ¬m thÃº thÃ nh cÃ´ng (10 ca) Â· <b>24</b> ngÆ°á»i Ä‘Ã£ Ä‘áº¡t</div>
                  <div class="bar"><div style="width:40%; background:linear-gradient(90deg, #16a34a, #60a5fa)"></div></div>
                  <div class="bstat">
                    <span>Tiáº¿n trÃ¬nh cá»§a báº¡n: <b>4/10</b> ca</span>
                    <span>CÃ²n 6 Ä‘á»ƒ Ä‘áº¡t</span>
                  </div>
                </div>
                <div style="display:grid;gap:8px;justify-items:end">
                  <span class="tag">Má»¥c tiÃªu: 10 ca</span>
                  <button class="btn" onclick="alert('Máº¹o Ä‘áº¡t '+ 'NgÆ°á»i dáº«n Ä‘Æ°á»ng')">ğŸ’¡ Máº¹o</button>
                </div>
            </div>
            <div class="brow" style="border-left:6px solid #ef444420"> <div class="bicon" style="background:conic-gradient(from 180deg, #ef444422, #fff); border-color:#ef444433">ğŸ“ˆ</div>
                <div>
                  <div class="bname">ChuyÃªn gia diá»…n Ä‘Ã n</div>
                  <div class="bmeta">Upvote cÃ¢u tráº£ lá»i â‰¥ 200 Â· <b>67</b> ngÆ°á»i Ä‘Ã£ Ä‘áº¡t</div>
                  <div class="bar"><div style="width:62%; background:linear-gradient(90deg, #ef4444, #fb7185)"></div></div>
                  <div class="bstat">
                    <span>Tiáº¿n trÃ¬nh cá»§a báº¡n: <b>123/200</b> upvote</span>
                    <span>CÃ²n 77 Ä‘á»ƒ Ä‘áº¡t</span>
                  </div>
                </div>
                <div style="display:grid;gap:8px;justify-items:end">
                  <span class="tag">Má»¥c tiÃªu: 200 upvote</span>
                  <button class="btn" onclick="alert('Máº¹o Ä‘áº¡t '+ 'ChuyÃªn gia diá»…n Ä‘Ã n')">ğŸ’¡ Máº¹o</button>
                </div>
            </div>
            <div class="brow" style="border-left:6px solid #0ea5e920"> <div class="bicon" style="background:conic-gradient(from 180deg, #0ea5e922, #fff); border-color:#0ea5e933">ğŸª</div>
                <div>
                  <div class="bname">NhÃ  tá»• chá»©c sá»± kiá»‡n</div>
                  <div class="bmeta">3 sá»± kiá»‡n Ä‘Æ°á»£c duyá»‡t Â· <b>15</b> ngÆ°á»i Ä‘Ã£ Ä‘áº¡t</div>
                  <div class="bar"><div style="width:33%; background:linear-gradient(90deg, #0ea5e9, #60a5fa)"></div></div>
                  <div class="bstat">
                    <span>Tiáº¿n trÃ¬nh cá»§a báº¡n: <b>1/3</b> sá»± kiá»‡n</span>
                    <span>CÃ²n 2 Ä‘á»ƒ Ä‘áº¡t</span>
                  </div>
                </div>
                <div style="display:grid;gap:8px;justify-items:end">
                  <span class="tag">Má»¥c tiÃªu: 3 sá»± kiá»‡n</span>
                  <button class="btn" onclick="alert('Máº¹o Ä‘áº¡t '+ 'NhÃ  tá»• chá»©c sá»± kiá»‡n')">ğŸ’¡ Máº¹o</button>
                </div>
            </div>
            <div class="brow" style="border-left:6px solid #22c55e20"> <div class="bicon" style="background:conic-gradient(from 180deg, #22c55e22, #fff); border-color:#22c55e33">ğŸ¤</div>
                <div>
                  <div class="bname">NgÆ°á»i tá»‘t bá»¥ng</div>
                  <div class="bmeta">5 ca nháº­n nuÃ´i thÃ nh cÃ´ng Â· <b>9</b> ngÆ°á»i Ä‘Ã£ Ä‘áº¡t</div>
                  <div class="bar"><div style="width:60%; background:linear-gradient(90deg, #22c55e, #60a5fa)"></div></div>
                  <div class="bstat">
                    <span>Tiáº¿n trÃ¬nh cá»§a báº¡n: <b>3/5</b> trÆ°á»ng há»£p</span>
                    <span>CÃ²n 2 Ä‘á»ƒ Ä‘áº¡t</span>
                  </div>
                </div>
                <div style="display:grid;gap:8px;justify-items:end">
                  <span class="tag">Má»¥c tiÃªu: 5 trÆ°á»ng há»£p</span>
                  <button class="btn" onclick="alert('Máº¹o Ä‘áº¡t '+ 'NgÆ°á»i tá»‘t bá»¥ng')">ğŸ’¡ Máº¹o</button>
                </div>
            </div>
        </div>
    </section>
  </main>
{% endblock %}


{% block extra_js %}
<script>
document.addEventListener("DOMContentLoaded", function () {
  const BADGES = [
    { id: "share-king", icon: "ğŸ…", name: "Vua sáº» chia", target: 50 },
    { id: "helpful-comment", icon: "ğŸ’¬", name: "BÃ¬nh luáº­n há»¯u Ã­ch", target: 100 },
    { id: "match-guide", icon: "ğŸ§­", name: "NgÆ°á»i dáº«n Ä‘Æ°á»ng", target: 10 },
    { id: "forum-expert", icon: "ğŸ“ˆ", name: "ChuyÃªn gia diá»…n Ä‘Ã n", target: 200 },
    { id: "event-host", icon: "ğŸª", name: "NhÃ  tá»• chá»©c sá»± kiá»‡n", target: 3 },
    { id: "good-samaritan", icon: "ğŸ¤", name: "NgÆ°á»i tá»‘t bá»¥ng", target: 5 },
  ];

  const USER_PROGRESS = {
    "share-king": 60, // âœ… Ä‘áº¡t
    "helpful-comment": 76,
    "match-guide": 4,
    "forum-expert": 123,
    "event-host": 1,
    "good-samaritan": 3,
  };

  const box = document.getElementById("display-badge-options");
  const label = document.getElementById("currently-selected-badge");
  if (!box || !label) {
    console.error("KhÃ´ng tÃ¬m tháº¥y pháº§n hiá»ƒn thá»‹ danh hiá»‡u (#display-badge-options)");
    return;
  }

  const achieved = BADGES.filter((b) => (USER_PROGRESS[b.id] || 0) >= b.target);

  box.innerHTML = `
    <div class="display-badge-option">
      <input type="radio" id="display-badge-none" name="display-badge" value="none" checked>
      <label for="display-badge-none">KhÃ´ng hiá»ƒn thá»‹ danh hiá»‡u</label>
    </div>
  `;

  if (achieved.length === 0) {
    box.innerHTML += `<p class="muted">Báº¡n chÆ°a Ä‘áº¡t Ä‘Æ°á»£c danh hiá»‡u nÃ o Ä‘á»ƒ hiá»ƒn thá»‹.</p>`;
  } else {
    achieved.forEach((b) => {
      box.innerHTML += `
        <div class="display-badge-option">
          <input type="radio" id="display-badge-${b.id}" name="display-badge" value="${b.id}">
          <label for="display-badge-${b.id}">${b.icon} ${b.name}</label>
        </div>`;
    });
  }

  box.querySelectorAll('input[name="display-badge"]').forEach((r) => {
    r.addEventListener("change", (e) => {
      if (e.target.value === "none") {
        label.textContent = "ChÆ°a chá»n danh hiá»‡u nÃ o.";
      } else {
        const picked = BADGES.find((b) => b.id === e.target.value);
        label.textContent = `Äang hiá»ƒn thá»‹: ${picked.icon} ${picked.name}`;
      }
    });
  });

  console.log("âœ… Danh hiá»‡u Ä‘Ã£ Ä‘áº¡t:", achieved.map((b) => b.name).join(", "));
});
</script>
{% endblock %}
